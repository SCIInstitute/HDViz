cmake_minimum_required(VERSION 2.8)

PROJECT(HDViz)
INCLUDE_DIRECTORIES(. config ann gle tclap)
set(CMAKE_MODULE_PATH "${HDViz_SOURCE_DIR}/")

FIND_PACKAGE(GLUT)
FIND_PACKAGE(OpenGL)
FIND_PACKAGE(FreeType)
FIND_PACKAGE(FTGL)

  
set(GLE_LINK_DIR 
   ${HDViz_SOURCE_DIR}/gle/
) 

set(ANN_LINK_DIR 
   ${HDViz_SOURCE_DIR}/ann/
)

ADD_SUBDIRECTORY(gle)
ADD_SUBDIRECTORY(ann)

option(BUILD_HDVIZ_IMAGE "Build hdviz for image data" OFF)
option(BUILD_HDVIZPORCESSING "Build HDViz preprocessing tool" ON)
 
# Use itk.  This sets up include/link directories for us.
if(BUILD_HDVIZ_IMAGE)
# Find common/itk
INCLUDE (${CMAKE_ROOT}/Modules/FindITK.cmake)
IF (USE_ITK_FILE)
  INCLUDE(${USE_ITK_FILE})
ENDIF(USE_ITK_FILE) 
INCLUDE_DIRECTORIES(${ITK_INCLUDE_DIR})
endif(BUILD_HDVIZ_IMAGE)

LINK_DIRECTORIES( ${GLE_LINK_DIR} )

INCLUDE_DIRECTORIES(${FTGL_INCLUDE_DIR} ${FREETYPE_INCLUDE_DIR_ft2build}  ${FREETYPE_INCLUDE_DIR_freetype2} ${GLUT_INCLUDE_DIR} )


ADD_EXECUTABLE(HDViz HDViz.cpp )
TARGET_LINK_LIBRARIES (HDViz 
    mygle 
    ${FTGL_LIBRARIES}  
    ${FREETYPE_LIBRARIES}  
    ${OPENGL_LIBRARIES}  
    ${GLUT_LIBRARIES}
)
SET_TARGET_PROPERTIES(HDViz PROPERTIES COMPILE_FLAGS -DFONTNAME=${CMAKE_CURRENT_SOURCE_DIR}/DejaVuSans.ttf) 


if(BUILD_HDVIZ_IMAGE)
ADD_EXECUTABLE(HDViz_3D HDViz.cpp )
TARGET_LINK_LIBRARIES (HDViz_3D 
    mygle 
    gfortran
    blas
    lapack   
    ${FTGL_LIBRARIES}  
    ${FREETYPE_LIBRARIES}  
    ${OPENGL_LIBRARIES}  
    ${GLUT_LIBRARIES}    
    ITKCommon 
    ITKIO 
)

ADD_EXECUTABLE(HDViz_2D HDViz.cpp )
TARGET_LINK_LIBRARIES (HDViz_2D 
    mygle 
    gfortran
    blas
    lapack   
    ${FTGL_LIBRARIES}  
    ${FREETYPE_LIBRARIES}  
    ${OPENGL_LIBRARIES}  
    ${GLUT_LIBRARIES}
    ITKCommon 
    ITKIO 
)
SET_TARGET_PROPERTIES( HDViz_2D PROPERTIES COMPILE_DEFINITIONS DIMENSION=2 COMPILE_FLAGS -DFONTNAME=${CMAKE_CURRENT_SOURCE_DIR}/DejaVuSans.ttf)
SET_TARGET_PROPERTIES( HDViz_3D PROPERTIES COMPILE_DEFINITIONS DIMENSION=3 COMPILE_FLAGS -DFONTNAME=${CMAKE_CURRENT_SOURCE_DIR}/DejaVuSans.ttf)
endif(BUILD_HDVIZ_IMAGE)



if(BUILD_HDVIZPORCESSING)
FIND_PACKAGE(LAPACK)
FIND_PACKAGE(BLAS)
ADD_EXECUTABLE(HDVizProcess HDVizProcess.cxx)
TARGET_LINK_LIBRARIES (HDVizProcess 
    blas
    lapack    
    gfortran
    myann 
)
endif(BUILD_HDVIZPORCESSING)

